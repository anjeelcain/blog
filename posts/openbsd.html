<!DOCTYPE html>
<html>
<head>
    <title>OpenBSD Deep Install</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <link rel="stylesheet" href="../styles.css" />
</head>
<body>
    <header>
        <a href=https://anjeelcain.github.io/blog/>home</a> 
        <h1>OpenBSD Deep Install</h1>
    </header>
    <p>A few months ago I started using OpenBSD because the Linux kernel was quickly proceeding down an unstable path. I looked for an alternative and the one that made the most sense to me was OpenBSD. (why?)</p>
    <p>Why? Simplicity and security are some of the reasons why I chose it. OpenBSD follows the Unix philosophy and does not bloat the system with “pointless features” that open doors to several security flaws. Additionally, they perform line-by-line auditing, which contributes to the code being very clean.</p>
    <p>Following the <a href="https://www.openbsd.org/faq/faq4.html">OpenBSD installation guide</a>, you will have a basic system installed on your machine. However, in this guide, I intend to show you some “dirty tricks” that I’ve learned and how to use OpenBSD as a desktop operating system. <img src="https://user-images.githubusercontent.com/82726847/221463720-d93975eb-5ebd-435b-980b-30e033dad643.png" /></p>
    <hr />
    <ol type="1">
    <li><a href="#file-sets">File Sets</a></li>
    <li><a href="#basic-configuration">Basic Configuration</a></li>
    <li><a href="#x">X</a>
    <ul>
    <li><a href="#xenodm">Xenodm</a></li>
    <li><a href="#startup-file">Startup file</a></li>
    <li><a href="#d-bus">D-bus</a></li>
    </ul></li>
    </ol>
    <hr />
    <h1 id="file-sets">File Sets</h1>
    <p>During the installation, you’ll come across a stage that establishes the base for your system, the file sets. Sets are “segmented parts” of the system, and you’ll have the option to select whether or not to include them.</p>
    <p>In my install, i selected these sets:</p>
    <pre><code>    [X] bsd           [X] comp72.tgz    [X] xshare72.tgz  
        [X] bsd.mp        [X] man72.tgz     [ ] xfont72.tgz  
        [ ] bsd.rd        [ ] game72.tgz    [X] xserv72.tgz  
        [X] base72.tgz    [X] xbase72.tgz     </code></pre>
    <p>Some sets are essential for a functional desktop, but the sets you need to choose will depend on your usage. For example, I don’t need the ramdisk or games sets, and in the case of the xfonts set, as I unchecked it, I will need to install fonts later to bring up X. I will install my preferred fonts, so I don’t need to have the default fonts that come with the system on my machine.</p>
    <h1 id="basic-configuration">Basic Configuration</h1>
    <p>The first thing that I see as essential step is disable the damn beep/bell.</p>
    <pre class="shell"><code>$ echo &#39;keyboard.bell.volume=0&#39; &gt;&gt; /etc/wsconsctl.conf  
    $ wsconsctl keyboard.bell.volume=0</code></pre>
    <p>Check for firmware updates and patches.</p>
    <pre class="shell"><code>$ syspatch &amp;&amp; fw_upgrade</code></pre>
    <p>Add your user to the staff and operator groups. These groups provide more <a href="https://man.openbsd.org/login.conf">permissions and resources</a>.</p>
    <pre class="shell"><code>$ usermod -G staff your_username_here  
    $ usermod -G operator your_username_here</code></pre>
    <p>Now, configure <a href="https://man.openbsd.org/doas"><code>doas</code></a>, a tool that allows us to run commands with privileged permissions, basically a simpler and more intuitive alternative to sudo.</p>
    <pre class="shell"><code>$ echo &#39;permit persist keepenv your_username_here&#39; &gt; /etc/doas.conf</code></pre>
    <p>Remove Google from NTPD. You can choose any domain to ping.</p>
    <pre><code>$ sed -i &#39;s/www\.google\.com/www.suckless.org/&#39; /etc/ntpd.conf  
    $ rcctl restart ntpd</code></pre>
    <p>You can improve disk perfomance, just add the <code>softdep</code> and <code>noatime</code> “flags” on your partitions in <code>/etc/fstab</code>. For example:</p>
    <pre class="shell"><code>9e8e56fe224a93.a / ffs rw,wxallowed,softdep,noatime 1 1</code></pre>
    <h1 id="x">X</h1>
    <h2 id="xenodm">Xenodm</h2>
    <p>You can start X with Xenodm or directly with xinit or xorg, but I recommend using Xenodm. First thing is enable xenodm to start.</p>
    <pre class="shell"><code>$ rcctl enable xenodm</code></pre>
    <h2 id="startup-file">Startup file</h2>
    <p>Now you need to configure your startup file, which you can create as ~/.xsession or configure in your Xenodm and place the directory of the file wherever you want. Example:</p>
    <pre><code># ~/.xsession  
      
    # Load envs variables  
    . $HOME/.profile  

    # Keyboard key delay  
    xset r rate 200 40 &amp;  

    # Keyboard layout  
    setxkbmap -layout us &amp;  
      
    # Disable core dump  
    ulimit -Sc 0 &amp;   

    exec cwm  </code></pre>
    <h2 id="d-bus">D-bus</h2>
    <p>You can disable the D-Bus session by simply setting this the environment variable above in your ~/.profile, for example, and loading it in your ~/.xsession, as shown in the previous example.</p>
    <p><code>export DBUS_SESSION_BUS_ADDRESS=no</code></p>
    
</body>
</html> 
